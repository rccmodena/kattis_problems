#!/usr/bin/env python3
"""
Author: Rudi CÃ©sar Comiotto Modena
Email: rudi.modena@gmail.com
"""

import os
import shutil
import requests
import zipfile
import io
from bs4 import BeautifulSoup
import re


def main(problem_name):
    '''
    Compile the C source code
    '''
    tests_website = f"https://open.kattis.com/problems/{problem_name}/file/statement/samples.zip"
    problems_folder = r"D:\\my_stuff\\current\\sandbox\\kattis\\kattis\\problems\\"

    folder_name = problems_folder + problem_name[0] + r'\\' + problem_name + r'\\'
    test_folder_name = folder_name + r'tests\\'

    if not os.path.exists(folder_name):
        os.makedirs(folder_name)
        shutil.copyfile(problems_folder + 'base.c', folder_name + problem_name + '.c')
        shutil.copyfile(problems_folder + 'base.cpp', folder_name + problem_name + '.cpp')
        shutil.copyfile(problems_folder + 'base.md', folder_name + problem_name + '.md')
        shutil.copyfile(problems_folder + 'base.py', folder_name + problem_name + '.py')

        os.makedirs(test_folder_name)
        tests_request = requests.get(tests_website)
        tests_zip = zipfile.ZipFile(io.BytesIO(tests_request.content))
        tests_zip.extractall(test_folder_name)

    else:
        print(F"Problem <{problem_name}> already created!")


def create_md_file(problem_name):
    #URL = f"https://open.kattis.com/problems/{problem_name}"
    #page = requests.get(URL)
    #soup = BeautifulSoup(page.content, 'html.parser')
    soup = BeautifulSoup(planina(), 'html.parser')

    problem_id = soup.find("strong", string="Problem ID: ").next_sibling.getText(strip=True)
    cpu_time_limit = soup.find("strong", string="CPU Time limit: ").next_sibling.getText(strip=True)
    memory_limit = soup.find("strong", string="Memory limit: ").next_sibling.getText(strip=True)
    difficulty = soup.find("strong", string="Difficulty:  ").next_sibling.getText(strip=True)
    author =  soup.find("strong", string="\n                                                    Author:                                            ").next_element#.getText(strip=True)
    source = soup.find("strong", string="Source:").parent.getText(strip=True)
    print("problem_id: ", problem_id)
    print("cpu_time_limit: ", cpu_time_limit)
    print("memory_limit: ", memory_limit)
    print("difficulty: ", difficulty)
    print("author: ", author)
    print("source: ", source)


def planina():
    return b'<!DOCTYPE html>\n\n\n<html lang="en">\n<head>\n    <meta charset="UTF-8" >\n    <meta http-equiv="X-UA-Compatible" content="IE=edge">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <title>Planina &ndash; Kattis, Kattis</title>\n\n    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css" rel="stylesheet">\n\n    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>\n    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>\n\n    <!-- Fonts/Icons -->\n    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">\n\n    <link href="//fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,800,700italic,800italic%7CMerriweather:400,400italic,700" rel="stylesheet" type="text/css">\n\n    <!-- Bootstrap CSS -->\n    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">\n\n    <!-- Bootstrap datetimepicker CSS-->\n    <link href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css" rel="stylesheet">\n\n    <!-- DateRangePicker CSS -->\n    <link href="//cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n\n    <!-- Editable and Select2 -->\n    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.4/select2.css" rel="stylesheet">\n\n    <link rel="shortcut icon" href="/favicon" />\n\n    <!-- Own CSS -->\n    <link rel="stylesheet" href="/css/system.css?03bf93=">\n    <style type="text/css">\n          .header {\n         background-color: rgb(240,176,52);\n     }\n     .header .main-nav > ul > li.current:before {\n         border-bottom-color: rgb(240,176,52);\n     }\n\n          div.page-content.clearfix.above-everything.alert.alert-danger { color: #31708f; background: #d9edf7; border-color: #bce8f1; }\r\ndiv.page-content.clearfix.above-everything.alert.alert-danger div.main-content { padding-bottom: 0; }\r\n\n         </style>\n\n    <script type="text/javascript">\n        window.page_loaded_at = new Date();\n        jQuery.noConflict();\n    </script>\n\n    <script type="text/javascript">\n    jQuery.ns = function (namespace) {\n        var parts = namespace.split(\'.\');\n        var last = window;\n        for (var i = 0; i < parts.length; i++) {\n            last = last[parts[i]] || (last[parts[i]] = {});\n        }\n        return last;\n    };\n</script>\n    <script>\njQuery.extend(jQuery.ns(\'Kattis.error\'), (function () {\n    var messages = {"INTERNAL_SERVER_ERROR":"Internal server error.","ACCESS_DENIED":"Access denied.","NOT_AUTHENTICATED":"Not authenticated.","METHOD_NOT_ALLOWED":"Method not allowed.","INVALID_JSON":"JSON cannot be decoded or encoded data is deeper than the recursion limit.","BAD_CSRF_TOKEN":"Token does not match session\'s csrf_token","SESSION_NAME_EMPTY":"Session\'s name must be non empty.","SESSION_START_TIME_EMPTY":"Session\'s start time must be non empty.","SESSION_START_TIME_PASSED":"Session\'s start time has already passed.","SESSION_DURATION_EMPTY":"Session\'s duration must be non empty.","SESSION_DURATION_NEGATIVE":"Session\'s duration must be a positive number.","SESSION_DURATION_EXCEEDED":"Maximum duration for the session was exceeded.","SESSION_ALREADY_STARTED":"The session has already started.","SESSION_ALREADY_FINISHED":"The session is already finished.","USER_CREATED_SESSION_DURATION_EXCEEDED":"Contest cannot be longer than 168 hours.","INVALID_PROBLEM_SCORE":"Invalid problem score.","INVALID_SESSION_SHORTNAME":"Invalid shortname for the session.","INVALID_SESSION_CUTOFF":"Invalid cutoff for the session.","INVALID_USER_NAME":"Invalid username or email.","SESSION_NOT_FOUND":"No such session.","COURSE_NOT_FOUND":"No such course.","OFFERING_NOT_FOUND":"No such offering.","TEACHER_NOT_FOUND":"No such teacher.","TEACHER_CANNOT_REMOVE_SELF":"You may not remove yourself as a teacher unless you are an administrator.","AUTHOR_NOT_FOUND":"No such author.","JUDGE_NOT_FOUND":"No such judge.","JUDGE_ALREADY_EXIST":"The user is already a judge.","TEACHER_ALREADY_EXIST":"The user is already a teacher.","PROBLEM_NOT_FOUND":"No such problem.","TEAM_NOT_FOUND":"No such team.","SESSION_PROBLEM_ALREADY_EXIST":"The problem has been already added to the session.","SESSION_PROBLEM_DOES_NOT_EXIST":"The problem does not relate to the session.","PROBLEM_INDEX_NEGATIVE":"Problem index must be non negative.","AUTHOR_IS_CURRENT_TEAM_MEMBER":"The user you tried to add is already a member of the current team.","AUTHOR_IS_ANOTHER_TEAM_MEMBER":"The user you tried to add is already a member of another team in the current session.","AUTHOR_IS_JUDGE":"The user you tried to add is a judge.","AUTHOR_IS_NOT_TEAM_MEMBER":"The user you tried to remove is not a team member.","JUDGE_IS_TEAM_MEMBER":"The user you tried to add is a session team member or invitee.","SESSION_PUBLISHING_DENIED":"You do not have permission to publish this session.","CANNOT_PUBLISH_HISTORICAL_SESSION":"You cannot publish a session with a historical start time.","INVALID_TEAM_NAME_TOO_LONG":"The team name you are trying to add is too long","TEAM_NAME_IS_NOT_VISIBLE":"The team name you are trying to add is not visible"};\n\n    return {\n        get_msg: function (error_code) {\n            return messages[error_code];\n        },\n\n        show_msg: function (base_message, error_code) {\n            if (error_code) {\n                alert(base_message + ": " + this.get_msg(error_code));\n            } else {\n                alert(base_message);\n            }\n        },\n\n        show_xhr_msg: function (elem, jqXHR) {\n            var base_message = elem.data(\'fail-msg\');\n            var code = jqXHR.responseJSON && jqXHR.responseJSON.error &&\n                       jqXHR.responseJSON.error.code;\n            this.show_msg(base_message, code);\n        }\n    }\n})());\n</script>\n\n    \n    <meta name="robots" content="noindex">\n    \n<script type="text/x-mathjax-config">\n    MathJax.Hub.Config({\n        tex2jax: {\n            ignoreClass: ".*",\n            inlineMath: [[\'$\',\'$\'], [\'\\\\(\',\'\\\\)\']]\n        },\n        CommonHTML: {\n            linebreaks: {\n                automatic: false\n            }\n        },\n        SVG: {\n            linebreaks: {\n                automatic: false\n            }\n        },\n        "HTML-CSS": {\n            linebreaks: {\n                automatic: false\n            }\n        },\n        MMLorHTML: {\n            prefer: { Firefox: "HTML" }\n        }\n    });\n</script>\n\n<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>\n\n\n    <script type="text/javascript">\nvar rumMOKey="a854f3a6dd7ee5e3b7d1641570b79c34";\n(function(){\nif(window.performance && window.performance.timing && window.performance.navigation) {\n\tvar site24x7_rum_beacon=document.createElement(\'script\');\n\tsite24x7_rum_beacon.async=true;\n\tsite24x7_rum_beacon.setAttribute(\'src\',\'//static.site24x7rum.eu/beacon/site24x7rum-min.js?appKey=\'+rumMOKey);\n\tdocument.getElementsByTagName(\'head\')[0].appendChild(site24x7_rum_beacon);\n}\n})(window)\n</script>\n\n    \n    <style type="text/css">\n        .header { margin-bottom: 0; }\n        .page-content.single { padding: 0; }\n        .problem-headline h1 { margin-top: 0; }\n    </style>\n\n</head>\n\n<body class="page-master-layout page-problem page-problem-layout">\n\n\n<div id="wrapper">\n    <header class="header">\n    <div class="background">\n        \n        <div class="wrap">\n            <div class="fl">\n                                    <a href="/"><img class="logo logo-open" src="/images/site-logo" alt="" /></a>\n                                <div class="title-wrapper">\n                    <div class="header-title">Kattis</div>\n                    <nav class="main-nav">\n                        <ul>\n                                                                                            \n                                <li class=""><a href="/problems">Problems</a></li>\n                                                                                            \n                                <li class=""><a href="/contests">Contests</a></li>\n                                                                                            \n                                <li class=""><a href="/ranklist">Ranklists</a></li>\n                                                                                            \n                                <li class=""><a href="/jobs">Jobs</a></li>\n                                                                                            \n                                <li class=""><a href="/help">Help</a></li>\n                            \n                                                    </ul>\n                    </nav>\n                </div>\n            </div>\n            <div class="user-side fr">\n\n                <nav class="user-nav">\n                    <ul class="user-nav-ul">\n                                                    <li>\n                                <form action="/search" class="site-search" method="GET">\n                                    <input type="text" name="q" placeholder="Search Kattis" />\n                                    <a href="#">\n                                        <i class="fa fa-search"></i>\n                                    </a>\n                                </form>\n                            </li>\n                        \n                                                                                    <li><a class="btn dark-bg" href="/login">Log in</a></li>\n                                                                        </ul>\n\n                </nav>\n\n            </div>\n        </div>\n    </div>\n</header>\n\n    <!--[if IE]>    <div class="alert alert-warning" role="alert">\n        <strong>You are using an outdated browser!</strong> Some features might not look or work like expected. Kattis supports the last two versions of major browsers. Please consider upgrading to a recent version!    </div>\n    <![endif]-->\n\n    \n    \n    \n    \n\n    <div class="container" style="width: 1170px!important">\n        \n    \n    \n\n\n        \n                    \n\n        \n        <div class="col-xs-9" style="padding: 0">\n            <div class="page-content single clearfix">\n                <section class="box clearfix main-content">\n                    \n                    \n\n<div class="problem-wrapper" data-copied-to-clipboard-text="Copied!">\n\n    <div class="problem-headline clearfix">\n        <div class="headline-wrapper"><h1>Planina</h1></div>\n    </div>\n\n            \n  <div class="problembody">\n    <p>Mirko and Slavko are filming a movie adaptation of the\n    popular SF novel \xe2\x80\x9cChicks in space 13\xe2\x80\x9d. The script requires them\n    to present a lot of different worlds so they decided to film\n    the entire movie in front of a green screen and add CGI\n    backgrounds later. Mirko heard that the best way to generate\n    artificial terrain is to use midpoint displacement\n    algorithm.</p>\n\n    <p>To start the algorithm, Mirko selects <span class=\n    "tex2jax_process">$4$</span> points forming a perfect square.\n    He then performs the following steps:</p>\n\n    <ol class="enumerate">\n      <li>\n        <p>On each side of the square, he adds a new point in the\n        exact middle of the side. The height of this new point is\n        the average height of the two points on that side.</p>\n      </li>\n\n      <li>\n        <p>In the exact center of the square he adds a new point\n        whose height is the average height of all <span class=\n        "tex2jax_process">$4$</span> square vertices, plus a small\n        random value.</p>\n      </li>\n    </ol>\n\n    <p>After those two steps are performed, he now has <span class=\n    "tex2jax_process">$4$</span> new squares. He performs the same\n    steps on the newly created squares again and again until he is\n    pleased with the results.</p>\n\n    <div id="fig:algo" class="figure">\n      <center>\n        <img src="/problems/planina/file/statement/en/img-0001.png"\n        alt="\\includegraphics[width=1.0\\textwidth ]{pic.pdf}"\n        style="width:100.00%">\n\n        <div class="caption">\n          <b>Figure 1</b>: Two iterations of the algorithm\n        </div>\n      </center>\n    </div>\n\n    <p>Mirko noticed that some of the points belong to more than\n    one square. In order to decrease memory consumption, he\n    calculates and stores such points only once. He now wonders how\n    many points in total will he need to store in memory after\n    <span class="tex2jax_process">$N$</span> iterations.</p>\n\n    <h2>Input</h2>\n\n    <p>The first and only line of input contains one integer\n    <span class="tex2jax_process">$N$</span> (<span class=\n    "tex2jax_process">$1 \\leq N \\leq 15$</span>), the number of\n    iterations.</p>\n\n    <h2>Output</h2>\n\n    <p>The first and only line of output should contain one number,\n    the number of points stored after <span class=\n    "tex2jax_process">$N$</span> iterations.</p>\n\n    <table class="sample" summary="sample data">\n      <tr>\n        <th>Sample Input 1</th>\n\n        <th>Sample Output 1</th>\n      </tr>\n\n      <tr>\n        <td>\n          <pre>1\n</pre>\n        </td>\n\n        <td>\n          <pre>9\n</pre>\n        </td>\n      </tr>\n    </table>\n\n    <table class="sample" summary="sample data">\n      <tr>\n        <th>Sample Input 2</th>\n\n        <th>Sample Output 2</th>\n      </tr>\n\n      <tr>\n        <td>\n          <pre>2\n</pre>\n        </td>\n\n        <td>\n          <pre>25\n</pre>\n        </td>\n      </tr>\n    </table>\n\n    <table class="sample" summary="sample data">\n      <tr>\n        <th>Sample Input 3</th>\n\n        <th>Sample Output 3</th>\n      </tr>\n\n      <tr>\n        <td>\n          <pre>5\n</pre>\n        </td>\n\n        <td>\n          <pre>1089\n</pre>\n        </td>\n      </tr>\n    </table>\n  </div>\n\n    \n</div>\n\n\n                </section>\n            </div>\n        </div>\n        <div class="col-xs-3" style="padding-right: 0; width: 285px!important">\n            \n<div class="page-content single clearfix">\n    <section class="box clearfix main-content" style="padding: 15px">\n        <div class="problem-sidebar sidebar-info"><div class="alt-buttons"><a style="width: 117px"href="/problems/planina/submit"class="kat-button kat-primary small"data-toggle="tooltip"data-placement="top"title="Submit"><i class="fa fa-upload"></i> Submit</a><a style="width: 117px; margin-left: 5px" href="/problems/planina/statistics"class="kat-button kat-info small"data-toggle="tooltip"data-placement="top"title="Problem statistics"><i class="fa fa-bar-chart-o"></i> Stats</a></div><div class="sidebar-info"><div class="problem-button-wrap"><div class="btn-group btn-group-sm btn-group-justified"></div></div></div><div class="sidebar-info"><p><strong>Problem ID: </strong> planina</p><p><strong>CPU Time limit: </strong> 1 second</p><p><strong>Memory limit: </strong> 1024 MB</p><p><strong>Difficulty:  </strong><span>1.3</span></p><div class="problem-download"><p><strong>Download: </strong><br><a href="/problems/planina/file/statement/samples.zip"download="planina.zip"}>Sample data files</a><br></p></div></div></div>\n    </section>\n</div>\n\n<div class="page-content single clearfix" style="margin-top: -15px">\n    <section class="box clearfix main-content problem-sidebar" style="padding: 5px 15px">\n        <div class="sidebar-info">\n                            <p>\n                    <strong>\n                                                    Author:                                            </strong>\n                    <a href="/problem-authors/Marko%20Ivankovi%C4%87">Marko Ivankovi\xc4\x87</a>                </p>\n            \n                            <p>\n                    <strong>Source:</strong>\n                                            <a href="/problem-sources/Croatian%20Open%20Competition%20in%20Informatics%202009/2010%2C%20contest%20%234">Croatian Open Competition in Informatics 2009/2010, contest #4</a>\n                                    </p>\n            \n                            <p>\n                    <strong>License:</strong>\n                                                                For educational use only\n                                                        </p>\n            \n            \n            \n                    </div>\n    </section>\n</div>\n\n\n        </div>\n    </div>\n\n\n</div>\n\n\n<div id="footer">\n    <div class="container">\n        <div class="row">\n            <div class="footer-info col-md-2 ">\n                \n                            </div>\n            <div class="footer-powered col-md-8">\n                <h4>\n                                      <a href="/rss/new-problems"><i class="fa fa-rss-square" style="color: orange"></i>&nbsp;RSS feed for new problems</a> |\n                                    Powered by&nbsp;Kattis                                      | <a href="https://www.patreon.com/kattis">Support Kattis on Patreon!</a>\n                                  </h4>\n            </div>\n        </div>\n    </div>\n</div>\n\n\n\n\n<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>\n<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>\n<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>\n<script src="//cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n<script src="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.4/select2.min.js"></script>\n<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.2.8/raphael.min.js"></script>\n<script src="/js/system.js?d86be2=" type="text/javascript"></script>\n\n\n\n\n<script defer src="https://static.cloudflareinsights.com/beacon.min.js/v652eace1692a40cfa3763df669d7439c1639079717194" integrity="sha512-Gi7xpJR8tSkrpF7aordPZQlW2DLtzUlZcumS8dMQjwDHEnw9I7ZLyiOj/6tZStRBGtGgN6ceN6cMH8z7etPGlw==" data-cf-beacon=\'{"rayId":"7022e7bd0807a628","token":"6651308a007d4d459b12876077322bfb","version":"2021.12.0","si":100}\' crossorigin="anonymous"></script>\n</body>\n</html>\n'

if __name__ == '__main__':
    print("Create .md file: (True/False)")
    md_file = True if input() == "True" else False
    print(md_file)
    print("Type the name of the problem: ")
    problem_name = input().lower()

    print(f"Do you want to create the problem: <{problem_name}>")
    print("Type YES to create.")
    create_problem = input()
    if create_problem == "YES":
        create_md_file(problem_name)
        # main(problem_name)
        print(f"Problem <{problem_name}> created with success!")
    else:
        print(f"Problem <{problem_name}> not created...")




